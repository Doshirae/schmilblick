<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>schmilblick</title>
        <script src="phaser.js"></script>
    </head>
    <body>

    <script type="text/javascript">

    window.onload = function() {

        //  Note that this html file is set to pull down Phaser 2.5.0 from the JS Delivr CDN.
        //  Although it will work fine with this tutorial, it's almost certainly not the most current version.
        //  Be sure to replace it with an updated version before you start experimenting with adding your own code.

        var game = new Phaser.Game(900, 750, Phaser.AUTO, '', { preload: preload, create: create, update: update, render: render });
        
        
        var coeff = 1;
        var timerPop;
        var monstre;
        var spawn;
        var tabMob = [];
        var tabSeq = [];
        var idMob = 0;
        var vie = 1;
       
       
        function preload () {
            game.stage.backgroundColor = '#85b5e1';
            game.load.crossOrigin = 'anonymous';
            game.load.image('monstre','images/monstre.png');
            game.load.image('monstre1','images/monstre1.png');
            game.load.image('monstre2','images/monstre2.png');
            game.load.image('monstre3','images/monstre3.png');
            
            game.load.audio('spawn', 'son/spawn.wav');
        }
        
        
        function create () { 
            spawn = game.add.audio('spawn');
            timerPop = game.time.events.loop(1*(Phaser.Timer.SECOND), createMob, this);
        }
        
        function update () {
           var cptMob = 0;
           while (tabMob[cptMob] != null){
               if (tabMob[cptMob].body.onFloor() && tabMob[cptMob].alive==true){
                   tabMob[cptMob].kill(); 
                   vie--;
                   if(vie <=0){
                       game.paused = true;
                   }
               }
               cptMob++;
           }
            
        }
        
        function render() {
           
        }
    
        function createMob (){
            
            var randomColonne;
            var randomMonstre;
            var nomMonstre;
            
            coeffDown();
            spawn.play();
            randomMonstre = game.rnd.integerInRange(1, 3);
            randomColonne = game.rnd.integerInRange(0, 6);
            nomMonstre = 'monstre'+randomMonstre;
            monstre = game.add.sprite(randomColonne*150, 0, nomMonstre);
            tabMob[idMob]=monstre;
            console.log(tabMob);
            idMob++;
            monstre.scale.setTo(0.5,0.5);
            game.physics.arcade.enable(monstre);
            monstre.body.collideWorldBounds = true;
            monstre.body.velocity.y = 500;
        }
        
        function coeffDown(){
            coeff = 1*coeff;
            timerPop.delay = coeff*1000;
        }
        
        //function createSeq

    };
    
    </script>
    </body>
</html>
